{"mode":"editor","version":1,"windowDimensions":{"x":0,"y":22,"width":1440,"height":874},"syntax":{"deserializer":"Syntax","grammarOverridesByPath":{}},"project":{"path":"/Users/zk/zaarly/wire-web","buffers":[{"text":"(ns wire.onboarding\n  (:use [compojure.core :only (defroutes GET POST ANY)])\n  (:require [nsfw.http :as http]\n            [nsfw.html :as html]\n            [nsfw.mongo :as mon]\n            [wire.user :as user]\n            [nsfw.env :as env]\n            [ring.util.response :refer (redirect)]\n            [wire.config :as config]\n            [wire.util :as wu]))\n\n(def $wire-logo-img [:img.logo {:src (wu/asset \"/img/wire-logo.png\")}] )\n\n(defn $layout [& {:keys [content\n                         r\n                         body-class\n                         brand-content\n                         nav]}]\n  (html/response\n    (html/html5\n      [:head\n       [:title \"Wire\"]\n       [:meta {:name \"viewport\" :content \"width=device-width, maximum-scale=0.65\"}]\n       (html/stylesheet (wu/asset \"/css/onboarding.css\"))]\n      [:body\n       {:class body-class}\n       (when (env/bool :non-prod)\n         [:div.non-prod-banner\n          \"Non-Production Environment\"])\n       [:div.sticky-footer-wrapper.clearfix\n        [:div.container\n         content\n         [:div.sticky-footer-push]]]\n       [:footer.clearfix\n        [:div.container\n         [:div.row\n          [:div.col-md-10.col-md-offset-1\n           [:div.footer-content\n            [:p\n             \"Wire is secure payment processor for service providers. \"\n             \"Contact us at \" [:a {:href \"mailto:support@paywithwire.com\"} \"support@paywithwire.com\"]\n             \" with any questions or comments.\"]\n            [:p\n             \"14 Mint Plaza\"\n             \"&nbsp;&nbsp;&nbsp;\"\n             \"4th Floor\"\n             \"&nbsp;&nbsp;&nbsp;\"\n             \"San Francisco, CA  94103\"]\n            [:p [:a {:href \"/tos\"} \"Terms of Service\"]]]]]]]\n       config/ga-tracking-tag])))\n\n(defn index [r]\n  ($layout\n    :body-class \"landing-page\"\n    :content\n    [:div.row\n     [:br] [:br]\n     [:div.col-md-5.col-md-offset-1\n      [:div.value-prop\n       [:h1\n        $wire-logo-img\n        \"Wire\"]\n       [:h3 \"The safe and easy way to charge your repeat customers.\"]\n       [:ul.bottom\n        [:li \"Accept all major credit & debit cards\"]\n        [:li \"2.9% + 30&#162; fee per charge\"]\n        [:li \"25&#162; fee per payout\"]\n        [:li \"Direct-deposit to your bank account\"]]\n       [:a.btn.btn-default.download-button.full-width\n        {:href \"https://itunes.apple.com/us/app/wire-safe-easy-way-to-charge/id873282063?mt=8\"} \"Download the iOS App\"]\n       [:br] [:br]\n       #_[:a.btn.btn-default.full-width.more-info\n          {:href \"/info\"} \"Tell Me More\"]]]\n     [:div.col-md-4.col-md-offset-1\n      [:img.iphone {:src (wu/asset \"/img/landing-iphone.jpg\")}]]]))\n\n(defn let-me-know [r]\n  ($layout\n    :body-class \"landing-page\"\n    :content\n    [:div.row\n     [:br] [:br]\n     [:div.col-md-10.col-md-offset-1\n      [:div.let-me-know\n       [:h1\n        $wire-logo-img\n        \"Wire\"]\n       [:h3 \"We're in closed beta right now.\"]\n       [:p \"Send us your email below, and we'll let you know when we can bring you on-board!\"]\n       [:form.let-me-know-form\n        {:method :post :action \"/let-me-know-post\"}\n        [:div.form-group\n         [:input.form-control {:type \"email\" :placeholder \"Your Email Address\" :name \"email\"}]]\n        [:div.form-group.submit-group\n         [:button.btn.btn-primary {:type \"submit\"} \"Let Me Know\"]]]]]]))\n\n(defn tos [r]\n  ($layout\n    :body-class \"landing-page\"\n    :content\n    [:div.row\n     [:br] [:br]\n     [:div.col-md-10.col-md-offset-1\n      [:div.let-me-know\n       [:h1\n        $wire-logo-img\n        \"Wire\"]\n       (-> \"src/md/tos.md\"\n           slurp\n           html/markdown)]]]))\n\n(defn let-me-know-post [r]\n  (mon/insert! :beta-list {:email (-> r :params :email)})\n  (http/redirect \"/let-me-know-success\"))\n\n(defn let-me-know-success [r]\n  ($layout\n    :body-class \"landing-page\"\n    :content\n    [:div.row\n     [:br] [:br]\n     [:div.col-md-10.col-md-offset-1\n      [:div.let-me-know\n       [:h1\n        $wire-logo-img\n        \"Wire\"]\n       [:h3 \"Thanks!\"]\n       [:p \"We'll let you know when we're ready to bring you on-board.\"]]]]))\n\n(defn ios-user-agent? [ua-str]\n  (or (re-find  #\"iPhone; CPU iPhone OS\" ua-str)\n      (re-find  #\"iPad; CPU OS\" ua-str)))\n\n(def open-on-ios-device-page\n  ($layout\n    :body-class \"landing-page\"\n    :content\n    [:div.row\n     [:div.col-md-10.col-md-offset-1\n      [:section.ios-redirect-content\n       [:h1\n        $wire-logo-img\n        \"Wire\"]\n       [:p \"Please open this page on your iOS device.\"]]]]))\n\n(defn ios-open-uri-in-app-page [app-path]\n  ($layout\n    :body-class \"landing-page\"\n    :content\n    [:div.row\n     [:div.col-md-10.col-md-offset-1\n      [:section.ios-redirect-content\n       [:h1\n        $wire-logo-img\n        \"Wire\"]\n       [:div\n        {:id \"install-instructions\"\n         :class \"invisible\"}\n        [:p\n         \"We apologize, we tried to open the Wire iOS app, but it looks like you don't have it installed.\"]\n        [:p\n         \"Please \"\n         [:a {:href \"/\"} \"install Wire\"]\n         \" and open this page on your iOS device.\"]]]]\n     [:script {:type \"text/javascript\"}\n      \"console.log(\\\"\" (str \"wire:/\" app-path) \"\\\");\"\n      \"window.location = \\\"\" (str \"wire:/\" app-path) \"\\\";\"\n      \"setTimeout(function(){\"\n      \"document.getElementById('install-instructions').className=\\\"\\\";\"\n      \"},500);\"]]))\n\n(defn ios-install-app-page [install-uri]\n  ($layout\n    :body-class \"landing-page\"\n    :content\n    [:div.row\n     [:div.col-md-10.col-md-offset-1\n      [:section.ios-redirect-content\n       [:h1\n        $wire-logo-img\n        \"Wire\"]\n       [:div\n        {:id \"install-instructions\"\n         :class \"invisible\"}\n        [:p\n           \"Touch &quot;Install&quot; on the pop-up to continue.\"]]]]\n     [:script {:type \"text/javascript\"}\n      \"console.log(\\\"\" install-uri \"\\\");\"\n      \"document.getElementById('install-instructions').className=\\\"\\\";\"\n      \"setTimeout(function(){\"\n      \"window.location = \\\"\" install-uri \"\\\";\"\n      \"},500);\"]]))\n\n(defroutes _routes\n  (GET \"/\" [] index)\n  (GET \"/about\" [] (fn [r] (redirect \"/\")))\n  (GET \"/app-edu/first-charge\" []\n    (fn [r]\n      ($layout\n        :body-class \"landing-page\"\n        :content\n        [:div.row\n         [:div.col-md-10.col-md-offset-1\n          [:h2 \"Congrats! You've just sent your first charge, what happens next?\"]\n          [:br]\n          [:ol\n           [:li\n            [:p \"Your customer will receive an invoice email with a link to the secure payment form, which looks like this:\"]\n            [:img {:src (wu/asset \"/img/customer-payment-view.png\")}]\n            [:p [:strong \"If your customer didn't recieve an invoice email, have them check their spam folder.\"]]]\n           [:li\n            [:p \"We'll collect the funds on your behalf when they submit their payment information. \" [:strong \"We'll send you a confirmation email once they've paid.\"]]]\n           [:li\n            [:p\n             \"If you've already \"\n             [:a {:href \"/iosapp/bank-account\"} \"set-up your bank account\"]\n             \" we'll \"\n             [:strong \"deposit the funds directly into your bank account\"]\n             \". Otherwise, we'll hold the funds for you until will can pay you out.\"]]]\n          [:p\n           \"Feel free to contact us at \"\n           [:a {:href \"mailto:support@paywithwire.com\"} \"support@paywithwire.com\"]\n           \" if you have any questions about this process.\"]]])))\n  (GET \"/let-me-know\" [] let-me-know)\n  (POST \"/let-me-know-post\" [] let-me-know-post)\n  (GET \"/let-me-know-success\" [] let-me-know-success)\n\n  (GET \"/tos\" [] tos)\n\n  (ANY \"/iosapp*\" []\n    (fn [r]\n      (let [ios-path (:* (:route-params r))\n            ios-path (if (or (not ios-path)\n                             (empty? ios-path))\n                       \"/\"\n                       ios-path)]\n        (if (ios-user-agent? (-> r\n                                 :headers\n                                 (get \"user-agent\")))\n          (ios-open-uri-in-app-page ios-path)\n          open-on-ios-device-page))))\n\n  (ANY \"/ios/install\" []\n    (fn [r]\n      (if (ios-user-agent? (-> r :headers (get \"user-agent\")))\n        (ios-install-app-page config/ios-install-uri)\n        open-on-ios-device-page))))\n\n(def routes _routes)\n","markers":{"markers":{"1":{"id":1,"range":[[69,54],[69,54]],"tailed":false,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":55,"goalBufferRange":null},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[{"patches":[{"oldRange":[[69,16],[69,28]],"newRange":[[69,16],[69,16]],"oldText":"/ios/install","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[69,16],[69,16]],"newRange":[[69,16],[69,93]],"oldText":"","newText":"https://itunes.apple.com/us/app/wire-safe-easy-way-to-charge/id873282063?mt=8","normalizeLineEndings":{},"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[69,0],[69,0]],"newRange":[[69,0],[70,0]],"oldText":"","newText":"        {:href \"/ios/install\"} \"Download the iOS App\"]\n","normalizeLineEndings":{"normalizeLineEndings":false},"markerPatches":{},"deserializer":"BufferPatch"},{"oldRange":[[70,0],[71,0]],"newRange":[[70,0],[70,0]],"oldText":"        {:href \"https://itunes.apple.com/us/app/wire-safe-easy-way-to-charge/id873282063?mt=8\"} \"Download the iOS App\"]\n","newText":"","normalizeLineEndings":{"normalizeLineEndings":false},"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[69,0],[69,0]],"newRange":[[69,0],[70,0]],"oldText":"","newText":"        {:href \"https://itunes.apple.com/us/app/wire-safe-easy-way-to-charge/id873282063?mt=8\"} \"Download the iOS App\"]\n","normalizeLineEndings":{"normalizeLineEndings":false},"markerPatches":{},"deserializer":"BufferPatch"},{"oldRange":[[70,0],[71,0]],"newRange":[[70,0],[70,0]],"oldText":"        {:href \"/ios/install\"} \"Download the iOS App\"]\n","newText":"","normalizeLineEndings":{"normalizeLineEndings":false},"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"}],"redoStack":[],"deserializer":"History"},"filePath":"/Users/zk/zaarly/wire-web/src/clj/wire/onboarding.clj","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"12f6fd26badd2f877cf69b38c5f90dafc24ac927","deserializer":"TextBuffer"}],"deserializer":"Project"},"workspace":{"paneContainer":{"root":{"items":[{"id":55,"softTabs":true,"displayBuffer":{"id":56,"softWrap":false,"editorWidthInChars":153,"scrollTop":955,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/zk/zaarly/wire-web/src/clj/wire/onboarding.clj","tabLength":2,"deserializer":"TokenizedBuffer"},"deserializer":"DisplayBuffer"},"deserializer":"Editor"}],"focused":true,"active":true,"deserializer":"Pane"},"deserializer":"PaneContainer"},"fullScreen":false,"deserializer":"Workspace"},"packageStates":{"fuzzy-finder":{"/Users/zk/zaarly/wire-web/src/clj/wire/onboarding.clj":1404163775339},"keybinding-resolver":{"attached":false},"metrics":{"sessionLength":1537364},"tree-view":{"directoryExpansionStates":{"src":{"clj":{"wire":{}}}},"hasFocus":false,"attached":true,"scrollLeft":0,"scrollTop":0,"width":200}}}